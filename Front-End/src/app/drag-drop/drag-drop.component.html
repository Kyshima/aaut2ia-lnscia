<div class="header">
  <h1>Crop AI</h1>
  <h2>Crop and Illness Identifier
  </h2>
</div>

<div class="panel helvetica" >
  <div class="center-panel">
    <ngx-file-drop dropZoneLabel="Drop files here" (onFileDrop)="dropped($event,0)" dropZoneClassName="filedropZone"
      contentClassName="filedropContent">
      <ng-template ngx-file-drop-content-tmp let-openFileSelector="openFileSelector" multiple="false">
        <div *ngIf="flag==true">
          <p>Drag a crop image (jpg)</p>
          <button type="button" class="btn-outline-secondary btn" (click)="openFileSelector()">Search</button>
        </div>
        <div *ngIf="flag==false" class="file-droped" >
          <p>{{ fileName }}</p>
          <button type="button" class="btn-primary btn" (click)="deleteFile(0)">Delete</button>
        </div>
      </ng-template>
    </ngx-file-drop>
  </div>
</div>
<div class="center">
  <button class="btn-primary btn btn-lg" style="font-size: 100%;margin: 15px;" (click)="compareFilesJcu(1)">Get Crop</button>
  <button class="btn-primary btn btn-lg" style="font-size: 100%;margin: 15px;" (click)="compareFilesJcu(2)">Get Illness</button>
  <button class="btn-primary btn btn-lg" style="font-size: 100%;margin: 15px;" (click)="compareFilesJcu(3)">Get Crop & Illness</button>
</div>


<div class="chatbot" >
  <ul class="chatbox">
    <li style="list-style-type: none">
      <div class="chat" class="chat outgoing" *ngIf="this.fileUrl">
        <p><img  [src]="this.fileUrl" alt="Uploaded Image"></p>
      </div>
      <div class="chat" class="chat incoming" *ngIf="answer != ''">
        <span class="material-symbols-outlined"><i class="fa-solid fa-robot"></i></span>
        <p>{{answer}}</p>
      </div>
    </li>
  </ul>
</div>

<div class="modal-wrapper" *ngIf="showError==true">
  <section class="modal" #modal>
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title">Error Uploading File</h6>
        <button type="button" class="modal-close" (click)="CloseModal()">
          <span aria-hidden="true">Ã—</span>
        </button>
      </div>
      <div class="modal-body">
        <p>{{ messageError }}</p>
      </div>
    </div>
  </section>
  <div class="modal-overlay" #overlay (click)="CloseModal()"></div>
</div>

<script>
  function resizeImageToDiv(imageSelector, divSelector) {
    var img = document.querySelector(imageSelector);
    var div = document.querySelector(divSelector);

    var imgWidth = img.width;
    var imgHeight = img.height;

    var divWidth = div.clientWidth;
    var divHeight = div.clientHeight;

    var widthRatio = divWidth / imgWidth;
    var heightRatio = divHeight / imgHeight;

    var minRatio = Math.min(widthRatio, heightRatio);

    img.style.width = imgWidth * minRatio + 'px';
    img.style.height = imgHeight * minRatio + 'px';
  }

</script>
